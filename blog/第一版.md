# 实现一个表单自动回填的谷歌插件

## 演示

<video src='./01.mp4' autoplay></video>



## 背景

我们在工作中经常会遇到需要填写表单，去尝试调接口或者复现一个问题的场景。这种场景下，每次输入的表单值都是固定格式的；如果表单比较少，而且值也很简单的时候，手动去输入没啥。但是表单一旦多了，输入表单的值变复杂了，那工作效率就不行了。最糟糕的是影响了划水的心情。



## 技术栈

首先，没谷歌插件相关的 `api` 啥事~。第一版只用 js 去实现，只需要借助一下谷歌插件配置文件的一丢丢配置规则即可。



## 分析实现过程

### 触发器

功能的启动和关闭按钮；它意味着功能的开启状态，这就需要一个变量 `enable` 来控制。那么它的点击作用就是对这个变量不断取反，改变自身显示状态的同时，还需要控制浮窗的显示隐藏。



### 浮窗

实现表单上面浮窗里的【记住】和【清楚】点击功能，就是这个插件的核心功能。数据的缓存和清楚，都是在 `localStorage ` 里进行，但它们并不是难点。**难点在于对应上**，我们一边撸一边讲解。



### 浮窗和表单元素的对应





## 具体实现

先画一个触发器吧

```js
const createTrigger = () => {
	const div = document.createElement('div')
	div.innerText = 'AutoFill'
	div.style.cssText = `
	position: fixed;
	z-index: 99999999;
	right: 50px;
	bottom: 50px;
	text-align: center;	
	line-height: 80px;
	width: 80px;
	height: 80px;
	border-radius: 50%;
	background-color: gray;
	color: #fff;
	cursor: pointer;
	box-shadow: rgb(101 82 255) 0 0 10px;
	user-select: none;
	`

	document.body.append(div)

	return div
}
```



再来一个点击事件

```js
const onClick = e => {
	e.target.style.backgroundColor = (enable = !enable) ? 'blue' : 'gray'
	controllFloatWindow(enable)
}
```

> 这里的 enable 就是功能的开启状态



### 控制浮窗的显示状态

首先我们需要搞明白，只有表单元素才需要这个浮窗。那么我们定义这样一组选择器：

```js
const FORMELEMENT = 'input,textarea,select,radio'
```

